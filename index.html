<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–ì—Ä–∞ ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–ª—ñ–≤</title>

<style>
:root{
  --bg:#f4f5f7;
  --card:#fff;
  --line:#e5e7eb;
  --blue:#0a5fa5;
  --good:#22c55e;
  --bad:#ef4444;
}
*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto}
body{margin:0;background:var(--bg)}

.topbar{
  height:46px;background:#2f2f2f;color:#fff;
  display:flex;justify-content:space-between;align-items:center;
  padding:0 14px;font-size:14px
}
.content{max-width:900px;margin:auto;padding:16px}
.card{
  background:var(--card);
  border-radius:14px;
  padding:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.08)
}
.center{display:flex;flex-direction:column;align-items:center;gap:14px}
.btn{
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:var(--blue);
  color:#fff;
  font-weight:700;
  font-size:15px;
}
input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--line);
  font-size:15px;
}
.list{
  list-style:none;
  padding:0;margin:0;
  width:100%;
  border:1px solid var(--line);
  border-radius:12px;
  overflow:hidden;
}
.item{
  padding:18px 14px;              /* ‚¨Ö –±—ñ–ª—å—à–µ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω—É */
  font-size:18px;
  font-weight:700;
  text-align:center;
  border-top:1px solid var(--line);
  background:#fff;
  touch-action:none;
  user-select:none;
}
.item:first-child{border-top:none}

/* –ø—ñ–¥—Å–≤—ñ—Ç–∫–∞ */
.item.good{background:#dcfce7;color:#14532d}
.item.bad{background:#fee2e2;color:#7f1d1d}

/* drag */
.item.dragging{
  position:fixed;
  z-index:1000;
  box-shadow:0 12px 25px rgba(0,0,0,.2);
}
</style>
</head>

<body>
<div class="topbar">
  <div id="scoreTop">–ë–∞–ª–∏: 0</div>
  <div id="lvlTop">–†—ñ–≤–µ–Ω—å: 0 / 5</div>
</div>

<div class="content">
<div class="card">

<!-- START -->
<div id="start" class="center">
  <h2>–ü–æ—á–∞—Ç–æ–∫ –≥—Ä–∏</h2>
  <input id="name" placeholder="–Ü–º‚Äô—è">
  <input id="email" placeholder="–ü–æ—à—Ç–∞">
  <button class="btn" id="startBtn">–ü–æ—á–∞—Ç–∏ –≥—Ä—É</button>
</div>

<!-- GAME -->
<div id="game" class="center" style="display:none">
  <h2 id="title">–ó–∞–ø–∞–º º—è—Ç–∞–π—Ç–µ —Å–ª–æ–≤–∞</h2>
  <div id="timer" style="font-size:42px;font-weight:800">8</div>

  <ul id="list" class="list"></ul>

  <button class="btn" id="checkBtn" style="display:none">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
</div>

<!-- END -->
<div id="end" class="center" style="display:none">
  <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
  <div id="summary"></div>
  <button class="btn" onclick="location.reload()">–ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
</div>

</div>
</div>

<script>
/* TELEGRAM */
const BOT_TOKEN="8517397402:AAERo7gAWPoCyCKpx9_T6b4tZRQazAZrX1k";
const CHAT_ID="1350269784";

/* GAME DATA */
const LEVELS=[3,4,5,6,7];
const WORDS=[
"–∫–∞–ª–∏–Ω–∞","–Ω–µ–±–æ","—Ä—ñ–∫–∞","–∑—ñ—Ä–∫–∞","–≤–µ—Å–Ω–∞","–º—Ä—ñ—è","–ø—ñ—Å–Ω—è","–ª—ñ—Å","—Ö–≤–∏–ª—è",
"—Å–æ–Ω—è—Ö","—Å—Ç–µ–∂–∫–∞","—Ç–µ–ø–ª–æ","—Å–≤—ñ—Ç–ª–æ","–Ω–∞–¥—ñ—è","–∫–Ω–∏–≥–∞","–º—ñ—Å—Ç–æ","—Å–∞–¥","–≤—ñ–∫–Ω–æ"
];

let level=0, score=0;
let correct=[], startTime=0;

/* DOM */
const startScr=start, gameScr=game, endScr=end;
const list=document.getElementById("list");
const timer=document.getElementById("timer");
const title=document.getElementById("title");
const checkBtn=document.getElementById("checkBtn");

/* START */
startBtn.onclick=()=>{
  if(!name.value||!email.value)return;
  startScr.style.display="none";
  gameScr.style.display="flex";
  startTime=Date.now();
  nextLevel();
};

function nextLevel(){
  document.getElementById("lvlTop").textContent=`–†—ñ–≤–µ–Ω—å: ${level+1} / 5`;
  title.textContent="–ó–∞–ø–∞–º º—è—Ç–∞–π—Ç–µ –ø–æ—Ä—è–¥–æ–∫ —Å–ª—ñ–≤";
  checkBtn.style.display="none";
  list.innerHTML="";
  timer.style.display="block";
  let count=8;
  timer.textContent=count;

  correct=shuffle(WORDS).slice(0,LEVELS[level]);
  correct.forEach(w=>addItem(w));

  const t=setInterval(()=>{
    count--;
    timer.textContent=count;
    if(count===0){
      clearInterval(t);
      startSort();
    }
  },1000);
}

function startSort(){
  title.textContent="–í—ñ–¥–Ω–æ–≤—ñ—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–ª—ñ–≤";
  timer.style.display="none";
  list.innerHTML="";
  shuffle(correct).forEach(w=>addItem(w));
  checkBtn.style.display="block";
  enableDrag();
}

/* CHECK */
checkBtn.onclick=()=>{
  const items=[...list.children];
  let ok=0;
  items.forEach((el,i)=>{
    if(el.textContent===correct[i]){
      el.classList.add("good");
      ok++;
    }else{
      el.classList.add("bad");
    }
  });
  score+=ok*5;
  scoreTop.textContent=`–ë–∞–ª–∏: ${score}`;

  setTimeout(()=>{
    level++;
    if(level<LEVELS.length) nextLevel();
    else finish();
  },900);
};

/* END */
function finish(){
  gameScr.style.display="none";
  endScr.style.display="flex";
  const time=Math.round((Date.now()-startTime)/1000);
  summary.innerHTML=`–ë–∞–ª–∏: <b>${score}</b><br>–ß–∞—Å: ${time} —Å`;

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=`+
    encodeURIComponent(`üß† –ì—Ä–∞ –∑—ñ —Å–ª–æ–≤–∞–º–∏\n${name.value}\n${email.value}\n–ë–∞–ª–∏: ${score}\n–ß–∞—Å: ${time} —Å`),
    {mode:"no-cors"});
}

/* HELPERS */
function addItem(t){
  const li=document.createElement("li");
  li.className="item";
  li.textContent=t;
  list.appendChild(li);
}
function shuffle(a){
  return a.slice().sort(()=>Math.random()-.5);
}

/* MOBILE DRAG */
function enableDrag(){
  let dragEl=null, startY=0;
  list.querySelectorAll(".item").forEach(el=>{
    el.onpointerdown=e=>{
      dragEl=el;
      startY=e.clientY;
      el.classList.add("dragging");
      document.onpointermove=ev=>{
        const dy=ev.clientY-startY;
        el.style.transform=`translateY(${dy}px)`;
        const rect=el.getBoundingClientRect();
        [...list.children].forEach(other=>{
          if(other!==el){
            const r=other.getBoundingClientRect();
            if(rect.top<r.top+r.height/2){
              list.insertBefore(el,other);
            }
          }
        });
      };
      document.onpointerup=()=>{
        el.classList.remove("dragging");
        el.style.transform="";
        document.onpointermove=null;
      };
    };
  });
}
</script>
</body>
</html>
